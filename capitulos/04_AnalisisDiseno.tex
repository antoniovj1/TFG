\chapter{Análisis y diseño}

\section{Análisis de requisitos}

Todo software se desarrolla para cubrir una necesidad, por lo que en este apartado vamos a describir los requisitos que se 
estiman necesarios para cubrir los objetivos propuestos.

\subsection{Descripción de los actores}

Los actores implicados serán dos: el \textbf{desarrollador} y el \textbf{usuario}.

\bigskip
El \textbf{desarrollador} será el encargado de solucionar los problemas de visualización de los datos en la plataforma, además de 
portar el desarrollo actual de la plataforma a un entorno de desarrollo continuo. También asumirá la administración de la 
plataforma ya que este tipo de rol está muy integrado con las labores de despliegue en el desarrollo continuo.

\bigskip
El \textbf{usuario} de la aplicación será cualquier persona que tenga interés por conocer datos internos de la Universidad de Granada 
fácilmente. El usuario no pertenece a ningún público objetivo concreto, por lo que no se tiene que considerar que tenga una
experiencia previa en navegador por sitios web.

\subsection{Requisitos Funcionales}

Los requisitos funcionales son las características que tiene que implementar el sistema para cubrir todas las necesidades de 
los distintos usuarios.

\bigskip
Al usuario lo único que le interesa es ver una página web estática con la información que desea 
consultar, para ello el desarrollador deberá hacer que sea posible que se generen siempre las tablas con los elementos de 
información. 

\bigskip
Por otra parte, el desarrollador quiere integrar el sistema en un desarrollo continuo, por lo que añadirá tests 
unitarios, test de cobertura, integración continua, despliegue automático y aprovisionamiento con tal fin.

\begin{itemize}
  \item \textbf{RF-1.} Administración portal:
    \begin{itemize}
    \item \textbf{RF-1.1.} Arrancar el portal mediante un script.
    \item \textbf{RF-1.2.} Detener el portal mediante un script.
    \end{itemize}
\end{itemize}

\begin{itemize}
  \item \textbf{RF-2.} Acceso información:
    \begin{itemize}
    \item \textbf{RF-2.1.} Consultar tablas con elementos de información.
    \end{itemize}
\end{itemize}

\begin{itemize}
  \item \textbf{RF-3.} Desarrollo continuo:
  \begin{itemize}
    \item \textbf{RF-3.1.} Realizar tests unitarios.
    \item \textbf{RF-3.2.} Realizar test de cobertura.
    \item \textbf{RF-3.2.} Usar integración continua.
    \item \textbf{RF-3.3.} Usar despliegue automático.
    \item \textbf{RF-3.4.} Usar aprovisionamiento.
    \end{itemize}
\end{itemize}

\subsection{Requisitos no Funcionales}

Los requisitos no funcionales son las características propias del desarrollo, pero que no tienen que estar relacionadas con su 
funcionalidad.

\begin{itemize}
  \item \textbf{RN-1.} Toda la programación del portal se hará en Node.js y los módulos que se usen deben ser instalables a 
  través de su gestor de paquetes NPM.
  \item \textbf{RN-2.} El portal se iniciará y se detendrá mediante scripts lanzados con NPM.
  \item \textbf{RN-3.} Para iniciar la ejecución del portal es necesario que reciba el puerto de escucha del servidor y la 
  dirección de acceso.
  \item \textbf{RN-4.} Todos los módulos se ejecutarán desde scripts lanzamos con NPM.
  \item \textbf{RN-5.} Los tests unitarios se realizarán en base a comportamientos esperados y valores de estados
  recibidos como contestación a las peticiones que se realicen al portal.
  \item \textbf{RN-6.} Los tests unitarios tienen que recibir las páginas del portal para ejecutarse.
  \item \textbf{RN-7.} El test de cobertura tiene que tener una automatización integrable con los tests unitarios. 
  \item \textbf{RN-8.} La integración continua se ejecutará automáticamente con cada cambio que se haga en la programación
  del portal.
  \item \textbf{RN-9.} El despliegue automático se realizará mediante conexiones SSH.
  \item \textbf{RN-10.} Tanto para el despliegue automático como para el aprovisionamiento es necesario indicar el usuario que
  lo realiza y el destino en el que se realiza.
\end{itemize}

\subsection{Requisitos de Información}

Los requisitos de información se refieren a la información que es necesaria almacenar en el sistema. La única información 
relevante que se va a almacenar son los datos descriptivos y de enlace de cada uno de los elementos del portal OpenData UGR 
que se van a mostrar en UGR Transparente.

\begin{itemize}
  \item \textbf{RI-1.} Datos abiertos.
  \begin{itemize}
    \item Información sobre cada uno de los elementos que se van a mostrar en el portal de transparencia como datos abiertos.
    \item Contenido: nombre, categoría, conjunto de datos, enlace a OpenData UGR, enlace al recurso.
  \end{itemize}
\end{itemize}

\section{Modelos de casos de uso}

Aunque ya se ha indicado que la parte funcional ya se encuentra implementada de forma previa a este proyecto, se van a incluir
unos modelos de caso de uso simples para dar un visión más clara del funcionamiento general de la plataforma UGR Transparente.

\subsection{Descripción básica de actores}

\begin{itemize}
  \item \textbf{Ac-1.} Desarrollador
  \begin{itemize}
   \item Descripción: Encargado del desarrollo y administración de la plataforma.
   \item Características: Su trabajo está en el lado del servidor que genera la página, nunca trabaja desde el lado del cliente.
   \item Relaciones: Ninguna.
   \item Atributos: Ninguno.
   \item Comentarios: Es el encargado de que la información se muestre en el portal y de añadir funcionalidades a la plataforma.
  \end{itemize}
  
  \item \textbf{Ac-2.} Usuario
  \begin{itemize}
   \item Descripción: Persona que usa la plataforma que consulta datos.
   \item Características: Es el usuario común que accederá a la página.
   \item Relaciones: Ninguna.
   \item Atributos: Ninguno.
   \item Comentarios: El usuario no es necesario que tenga ningún conocimiento previo al uso de la plataforma, simplemente
   accederá y consultará los datos que sean de su interes.
  \end{itemize}
\end{itemize}

\subsection{Descripción casos de uso}

\begin{itemize}
  \item \textbf{CU-1.} Iniciar plataforma
  \begin{itemize}
    \item Actores: Desarrollador
    \item Tipo: Primario, Esencial
    \item Referencias:
    \item Precondición: El servidor esté detenido.
    \item Postcondición: El portal será accesible públicamente.
    \item Autor: \autor
    \item Versión: 1.0
    \item Propósito: Arrancar el servidor del portal UGR Transparente.
    \item Resumen: Cuando se ejecuta el script de inicio de la aplicación, arranca el servidor y el portal será accesible desde
    internet.
    \begin{table}[!hbt]
      \begin{center}
	\begin{tabular}{|l|l|l|l|}
	  \hline
	  \multicolumn{4}{|c|}{{\bf Curso normal}}                                                                                                                                                                                       \\ \hline
	  {\it 1} & 
	  \begin{tabular}[c]{@{}l@{}}
	    Administrador: da orden de\\
	    que se inicie la plataforma.
	  \end{tabular} &
	  &
	  \\ \hline
	  &
	  &
	  {\it 2a} &
	  \begin{tabular}[c]{@{}l@{}}
	    Comprueba que el servidor\\
	    está detenido e inicia la\\
	    plataforma.
	  \end{tabular}
	  \\ \hline
	\end{tabular}
	\caption{Curso normal de CU-1. Iniciar plataforma}
	\label{table:cn_cu_1}
      \end{center}
    \end{table}
    \begin{table}[!hbt]
      \begin{center}
	\begin{tabular}{|l|l|}
	  \hline
	  \multicolumn{2}{|c|}{{\bf Curso alterno}}
	  \\ \hline
	  {\it 2b} &
	  \begin{tabular}[c]{@{}l@{}}
	    Si el servidor está funcionando, no se ejecuta el script de\\
	    arranque del servidor.\end{tabular}\\
	    \hline
	\end{tabular}
	\caption{Curso alterno de CU-1. Iniciar plataforma}
	\label{table:ca_cu_1}
      \end{center}
    \end{table}
  \end{itemize}
 
  \item \textbf{CU-2.} Detener plataforma
  \begin{itemize}
    \item Actores: Desarrollador
    \item Tipo: Primario, Esencial
    \item Referencias:
    \item Precondición: El servidor esté funcionando.
    \item Postcondición: El portal deja de estar operativo.
    \item Autor: \autor
    \item Versión: 1.0
    \item Propósito: Detener el servidor del portal UGR Transparente.
    \item Resumen: Cuando se ejecuta el script de detención de la aplicación, se detiene el servidor y el portal deja de estar
    accesible desde internet.
    \begin{table}[!hbt]
      \begin{center}
	\begin{tabular}{|l|l|l|l|}
	  \hline
	  \multicolumn{4}{|c|}{{\bf Curso normal}}                                                                                                                                                                                       \\ \hline
	  {\it 1} & 
	  \begin{tabular}[c]{@{}l@{}}
	    Administrador: da orden de\\
	    que se detenga la plataforma.
	  \end{tabular} &
	  &
	  \\ \hline
	  &
	  &
	  {\it 2a} &
	  \begin{tabular}[c]{@{}l@{}}
	    Comprueba que el servidor\\
	    está iniciado y detiene la\\
	    plataforma.
	  \end{tabular}
	  \\ \hline
	\end{tabular}
	\caption{Curso normal de CU-2. Detener plataforma}
	\label{table:cn_cu_2}
      \end{center}
    \end{table}
    \begin{table}[!hbt]
      \begin{center}
	\begin{tabular}{|l|l|}
	  \hline
	  \multicolumn{2}{|c|}{{\bf Curso alterno}}
	  \\ \hline
	  {\it 2b} &
	  \begin{tabular}[c]{@{}l@{}}
	    Si el servidor no está funcionando, no se ejecuta el script de\\
	    parada del servidor.\end{tabular}\\
	    \hline
	\end{tabular}
	\caption{Curso alterno de CU-2. Detener plataforma}
	\label{table:ca_cu_2}
      \end{center}
    \end{table}
  \end{itemize}
 
  \item \textbf{CU-3.} Consultar datos
  \begin{itemize}
    \item Actores: Usuario
    \item Tipo: Primario, Esencial
    \item Referencias:
    \item Precondición: Existan archivos con los datos abiertos.
    \item Postcondición:
    \item Autor: \autor
    \item Versión: 1.0
    \item Propósito: El usuario consulta los datos mostrador en el portal UGR Transparente.
    \item Resumen: El usuario que accede al portal de transparencia, navega a través de las distintas categorías y selecciona
    aquella en la que está interesado en conocer.
  \end{itemize}
 
  \item \textbf{CU-4.} Realizar tests unitarios
  \begin{itemize}
    \item Actores: Desarrollador
    \item Tipo: Primario, Esencial
    \item Referencias:
    \item Precondición: Existan tests unitarios.
    \item Postcondición: 
    \item Autor: \autor
    \item Versión: 1.0
    \item Propósito: Realizar tests unitarios para comprobar las funcionalidades de la aplicación.
    \item Resumen: Cada vez que se añadan nuevas páginas o funcionalidades al portal, se comprueba que funcionan correctamente.
  \end{itemize}
 
  \item \textbf{CU-5.} Realizar tests de cobertura
  \begin{itemize}
    \item Actores: Desarrollador
    \item Tipo: Primario, Esencial
    \item Referencias: (CU-4.) Realizar tests unitarios
    \item Precondición: Existan tests unitarios.
    \item Postcondición: 
    \item Autor: \autor
    \item Versión: 1.0
    \item Propósito: Realizar test de cobertura para comprobar calidad de los tests unitarios.
    \item Resumen: Para comprobar si los tests unitarios cumplen correctamente con su función se analiza el porcentaje del
    código que está cubierto por los mismos.
  \end{itemize}
 
  \newpage
  \item \textbf{CU-6.} Usar integración continua
  \begin{itemize}
    \item Actores: Desarrollador
    \item Tipo: Primario, Esencial
    \item Referencias: (CU-4.) Realizar tests unitarios
    \item Precondición: Existan test unitarios.
    \item Postcondición: Se genera un informe con el resultado de los tests unitarios.
    \item Autor: \autor
    \item Versión: 1.0
    \item Propósito: Comprobar si los cambios en la aplicación provocan errores.
    \item Resumen: Cuando se efectúan cambios en la aplicación automáticamente se ejecutan los tests unitarios para comprobar si
    los cambios introcudidos provocan conflictos en la plataforma.
  \end{itemize}
 
  \item \textbf{CU-.7 } Usar despliegue automático
  \begin{itemize}
    \item Actores: Desarrollador
    \item Tipo: Primario, Esencial
    \item Referencias: (CU-1.) Iniciar plataforma
    \item Precondición: 
    \item Postcondición: Los cambios introducidos son aplicados en la plataforma.
    \item Autor: \autor
    \item Versión: 1.0
    \item Propósito: Aplicar automáticamente los cambios realizados a la aplicación. 
    \item Resumen: Para no tener que acceder manualmente al servidor de la plataforma y tener que desplegar los cambios 
    introducidos, desde el entorno de desarrollo desplegamos automáticamente los cambios en el servidor.
  \end{itemize}
 
  \item \textbf{CU-.8 } Usar aprovisionamiento
  \begin{itemize}
    \item Actores: Desarrollador
    \item Tipo: Primario, Esencial
    \item Referencias: (CU-1.) Iniciar plataforma
    \item Precondición: 
    \item Postcondición: El portal queda instalado en la infraestructura seleccionada.
    \item Autor: \autor
    \item Versión: 1.0
    \item Propósito: Instalar automáticamente el portal en una infraestructura dada.
    \item Resumen: Se instalarán automáticamente todos los elementos necesarios para poner en funcionamiento el portal en 
    cualquier infraestructura que se indique.
  \end{itemize}
 \end{itemize}

\section{Diagrama de paquetes}

\begin{figure}[!h]
  \begin{center}
  \includegraphics[width=0.8\textwidth]{imagenes/diagrama_paquetes.png}
  \caption[diagrama_paquetes]{Diagrama de paquetes}
  \label{fig:diagrama_paquetes}
  \end{center}
\end{figure}
 
\section{Diagramas de casos de uso}

\begin{figure}[!h]
  \begin{center}
  \includegraphics[width=0.8\textwidth]{imagenes/diagrama_casos_uso_administracion_portal.png}
  \caption[casos_uso_ap]{Diagrama de casos de uso: paquete Administración portal}
  \label{fig:casos_uso_ap}
  \end{center}
\end{figure}

\begin{figure}[!h]
  \begin{center}
  \includegraphics[width=0.8\textwidth]{imagenes/diagrama_casos_uso_acceso_informacion.png}
  \caption[casos_uso_ai]{Diagrama de casos de uso: paquete Acceso información}
  \label{fig:casos_uso_ai}
  \end{center}
\end{figure}

\begin{figure}[!h]
  \begin{center}
  \includegraphics[width=0.8\textwidth]{imagenes/diagrama_casos_uso_desarrollo_continuo.png}
  \caption[casos_uso_dc]{Diagrama de casos de uso: paquete Desarrollo continuo}
  \label{fig:casos_uso_dc}
  \end{center}
\end{figure}

\newpage
\section{Diagramas de actividad}

\begin{figure}[!h]
  \begin{center}
  \includegraphics[width=0.8\textwidth]{imagenes/diagrama_actividad_cu_1.png}
  \caption[diag_act_cu_1]{Diagrama de actividad CU-1. Iniciar plataforma}
  \label{fig:diag_act_cu_1}
  \end{center}
\end{figure}

\begin{figure}[!h]
  \begin{center}
  \includegraphics[width=0.8\textwidth]{imagenes/diagrama_actividad_cu_2.png}
  \caption[diag_act_cu_2]{Diagrama de actividad CU-2. Detener plataforma}
  \label{fig:diag_act_cu_2}
  \end{center}
\end{figure}

\begin{figure}[!h]
  \begin{center}
  \includegraphics[width=0.8\textwidth]{imagenes/diagrama_actividad_cu_3.png}
  \caption[diag_act_cu_3]{Diagrama de actividad CU-3. Consultar datos}
  \label{fig:diag_act_cu_3}
  \end{center}
\end{figure}

\begin{figure}[!h]
  \begin{center}
  \includegraphics[width=0.8\textwidth]{imagenes/diagrama_actividad_cu_4.png}
  \caption[diag_act_cu_4]{Diagrama de actividad CU-4. Realizar tests unitarios}
  \label{fig:diag_act_cu_4}
  \end{center}
\end{figure}

\begin{figure}[!h]
  \begin{center}
  \includegraphics[width=0.8\textwidth]{imagenes/diagrama_actividad_cu_5.png}
  \caption[diag_act_cu_5]{Diagrama de actividad CU-5. Realizar tests de cobertura}
  \label{fig:diag_act_cu_5}
  \end{center}
\end{figure}

\begin{figure}[!h]
  \begin{center}
  \includegraphics[width=0.8\textwidth]{imagenes/diagrama_actividad_cu_6.png}
  \caption[diag_act_cu_6]{Diagrama de actividad CU-6. Usar integración continua}
  \label{fig:diag_act_cu_6}
  \end{center}
\end{figure}

\begin{figure}[!h]
  \begin{center}
  \includegraphics[width=0.8\textwidth]{imagenes/diagrama_actividad_cu_7.png}
  \caption[diag_act_cu_7]{Diagrama de actividad CU-7. Usar despliegue continuo}
  \label{fig:diag_act_cu_7}
  \end{center}
\end{figure}

\begin{figure}[!h]
  \begin{center}
  \includegraphics[width=0.8\textwidth]{imagenes/diagrama_actividad_cu_8.png}
  \caption[diag_act_cu_8]{Diagrama de actividad CU-8. Usar aprovisionamiento}
  \label{fig:diag_act_cu_8}
  \end{center}
\end{figure}

\section{Diagramas de secuencia}

\section{Diseño de los procedimientos}

[No hay clases ni objetos propios. Todo en base a llamadas a procedimientos.]